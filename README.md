# Estate Gate Pass Software API Documentation

This document provides an overview of the API for the Estate Gate Pass Software. The software allows residents to generate tokens with expiration times that can be shared with visitors and security personnel. Security personnel can verify the validity of the token when presented by a visitor.

---

## Table of Contents
1. [Overview](#overview)
2. [Base URL](#base-url)
3. [Authentication](#authentication)
4. [Endpoints](#endpoints)
    - [Generate Token](#generate-token)
    - [Verify Token](#verify-token)
5. [Error Codes](#error-codes)
6. [Example Usage](#example-usage)

---

## Overview

The Estate Gate Pass Software is designed to streamline the process of granting access to visitors in a gated community. Residents can generate secure tokens with an expiration time, which are then sent to visitors and security personnel. When a visitor arrives, security personnel can verify the token's validity before granting access.

---

## Base URL

All API requests should be made to the following base URL:
https://api.estategatepass.com/v1

---

## Authentication

To use the API, residents must authenticate using their unique API key. This key should be included in the `Authorization` header of each request as a Bearer token.

Example:

Authorization: Bearer <your_api_key>

---

## Endpoints

### Generate Token

#### Description
Generates a token with an expiration time for a specific visitor.

#### Endpoint


#### Request Body
| Field           | Type    | Required | Description                                                                  |
|-----------------|---------|----------|------------------------------------------------------------------------------|
| `visitor_name`  | string  | Yes      | Name of the visitor.                                                         |
| `visitor_phone` | string  | Yes      | Phone number of the visitor (optional if email is provided).                 |
| `visitor_email` | string  | No       | Email address of the visitor (optional if phone is provided).                |
| `expiration`    | integer | Yes      | Expiration time in minutes from the current time.                            |

#### Response
```json
{
  "token": "abc123xyz",
  "expires_at": "2023-10-01T12:00:00Z"
}
```

Example Request

```
curl -X POST https://api.estategatepass.com/v1/tokens \
-H "Authorization: Bearer <your_api_key>" \
-H "Content-Type: application/json" \
-d '{
  "visitor_name": "John Doe",
  "visitor_phone": "+1234567890",
  "expiration": 60
}'
```


## Verify Token 
### Description
Verifies the validity of a token generated by a resident.

#### Endpoint
`GET /tokens/{token}`

### Path Parameters

| Parameter | Type | Required | Description               |
|-----------|------|----------|---------------------------|
| token     |string| Yes      | The token to be verified. |

### Response
If the token is valid:
```
{
  "valid": true,
  "visitor_name": "John Doe",
  "visitor_phone": "+1234567890",
  "expires_at": "2023-10-01T12:00:00Z"
}
```

If the token is invalid or expired:
```
{
  "valid": false,
  "message": "Token has expired or is invalid."
}
```

#### Example Request
```aiignore
curl -X GET https://api.estategatepass.com/v1/tokens/abc123xyz \
-H "Authorization: Bearer <your_api_key>"
```

## Error Codes

| HTTP STATUS CODE   | MEANING                                                            |
|--------------------|--------------------------------------------------------------------|
| 200 OK             | Successful request.                                                |
| 400 Bad Request    | Invalid request format or missing required fields.                 |
| 401 Unauthorized   | Missing or invalid API key.                                        |
| 404 Not Found      | Token not found or does not exist.                                 |
| 410 Gone           | Token has expired.                                                 |
| 500                | Internal Server Error An unexpected error occurred on the server.  |

### Example Usage
#### Generating a Token
A resident wants to generate a token for a visitor named "Jane Smith" with a phone number "+0987654321" that expires in 30 minutes.
```
curl -X POST https://api.estategatepass.com/v1/tokens \
-H "Authorization: Bearer <your_api_key>" \
-H "Content-Type: application/json" \
-d '{
  "visitor_name": "Jane Smith",
  "visitor_phone": "+0987654321",
  "expiration": 30
}'
```

#### Response:
```
{
  "token": "xyz987abc",
  "expires_at": "2023-10-01T11:30:00Z"
}
```

### Verifying a Token
Security personnel want to verify the token "xyz987abc".
```aiignore
curl -X GET https://api.estategatepass.com/v1/tokens/xyz987abc \
-H "Authorization: Bearer <your_api_key>"
```

Response (if valid):
```aiignore
{
  "valid": true,
  "visitor_name": "Jane Smith",
  "visitor_phone": "+0987654321",
  "expires_at": "2023-10-01T11:30:00Z"
}
```

Response (if expired or invalid):
```aiignore
{
  "valid": false,
  "message": "Token has expired or is invalid."
}
```
